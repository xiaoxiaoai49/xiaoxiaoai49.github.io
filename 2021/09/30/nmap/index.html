<!DOCTYPE html><html lang="zh-CN "><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hongxiaodou || nmap</title>
    <meta name="author" content="hongxiaodou">
    <meta name="description" content="林深不见鹿，山巅自相逢 ">
    <meta name="keywords" content=" ">
    <link rel="icon" href="/images/1.png">
    <link rel="stylesheet" href="/css/antd.min.css">
    
    <link rel="stylesheet" href="/css/full-theme.css">
    
    <script src="/js/vue.js"></script>
    <script src="/js/antd.min.js"></script>
<!-- hexo injector head_end start --><style>
.body hanla:after {
    content: ' ';
    display: inline;
    font-family: Arial;
    font-size: 0.89em;
}

html code hanla,
html pre hanla,
html kbd hanla,
html samp hanla {
    display: none;
}

html ol > hanla,
html ul > hanla {
    display: none;
}
</style><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head>

<body>

    <div id="loading" style="height: 100vh; width: 100%; position: fixed;display: flex;z-index: 200; justify-content: space-between;">
        <div id="loadleft" style="width: 50%;background-color: #ffffff;transition: width 0.6s ease-out;"></div>
        <div id="loadright" style="width: 50%;background-color: #ffffff;transition: width 0.6s ease-out;"></div>
        <div style="position: fixed; height: 100vh; width: 100%;display: flex;justify-content: center;align-items: center;">
            <div id="loadcontent" style="width:400px;height:400px;padding:50px;border-radius:50%;display:flex;justify-content:center;align-items:center;border:solid 10px#a3ddfb; text-align:center;opacity:1;transition:opacity 0.3s ease-out;">
                <div>
                    <h2>LOADING...</h2>
                    <p><hanla></hanla>加载过慢请开启缓存<hanla></hanla>(浏览器默认开启)</p>
                    <div>
                        <img src="/dancingkitty.gif" alt="loading">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="layout">
        <transition name="into">
            <div v-show="show_page" style="display: none;">
                <div id="menu_show">
                     
<nav id="menu">
    <div class="desktop-menu">
        <a href="/">
            <span class="title">Hongxiaodou</span>
        </a>
        
        <a href="/">
            <span>
                <a-icon type="home" theme="filled">
            </a-icon></span>
            <span><hanla></hanla>主页</span>
        </a>
        
    </div>

    <div :class="'phone-menu ' + menu_show" id="phone-menu">
        <div :class="'title'" @click="menu_show=!menu_show">
            <span style="margin-right: 10px;">
                <a-icon type="appstore" theme="filled">
            </a-icon></span>
            <span><hanla></hanla>Hongxiaodou</span>
        </div>
        <div class="items" v-show="menu_show">
            
            <a href="/">
                <div class="item">
                    <div style="min-width:20px; max-width:50px; width: 10%">
                        <a-icon type="home" theme="filled">
                    </a-icon></div>
                    <div style="min-width:100px;max-width: 150%;width: 20%;"><hanla></hanla>主页</div>
                </div>
            </a>
            
        </div>
        <div class="curtain" v-show="menu_show"></div>
    </div>

</nav>
                </div>

                <div id="main">
                     
<link rel="stylesheet" href="/css/post-body.css">
<div class="article">
    <div>
        <h1>nmap </h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <a-icon type="calendar" theme="filled">
            </a-icon></span>
            2021/9/30
        </span>

        
        <span class="category">
            <a href="/categories/工具使用篇">
                <span class="icon">
                    <a-icon type="book" theme="filled">
                </a-icon></span>
                工具使用篇
            </a>
        </span>
        

        
    </div>

    <div class="content" v-pre="">
        <h2 id="基本扫描命令"><a href="#基本扫描命令" class="headerlink" title="基本扫描命令"></a>基本扫描命令</h2><span id="more"></span>
<pre><code><hanla></hanla>1. nmap -sT 192.168.96.4  //TCP<hanla></hanla>连接扫描，不安全，慢

2. nmap -sS 192.168.96.4  //SYN<hanla></hanla>扫描,<hanla></hanla>使用最频繁，安全，快

3. nmap -Pn 192.168.96.4  //<hanla></hanla>目标机禁用<hanla></hanla>ping，绕过<hanla></hanla>ping<hanla></hanla>扫描

4. nmap -sU 192.168.96.4  //UDP<hanla></hanla>扫描,<hanla></hanla>慢,<hanla></hanla>可得到有价值的服务器程序

5. nmap -sI 僵尸<hanla></hanla>ip 目标<hanla></hanla>ip  //<hanla></hanla>使用僵尸机对目标机发送数据包

6. nmap -sA 192.168.96.4  //<hanla></hanla>检测哪些端口被屏蔽

7. nmap 192.168.96.4 -p <portnumber>  //<hanla></hanla>对指定端口扫描

8. nmap 192.168.96.1/24 //<hanla></hanla>对整个网段的主机进行扫描

9. nmap 192.168.96.4 -oX myscan.xml //<hanla></hanla>对扫描结果另存在<hanla></hanla>myscan.xml

10. nmap -T1~6 192.168.96.4  //<hanla></hanla>设置扫描速度，一般<hanla></hanla>T4<hanla></hanla>足够。

11. nmap -sV 192.168.96.4  //<hanla></hanla>对端口上的服务程序版本进行扫描

12. nmap -O 192.168.96.4  //<hanla></hanla>对目标主机的操作系统进行扫描

13. nmap -sC <scirptfile> 192.168.96.4  //<hanla></hanla>使用脚本进行扫描，耗时长

14. nmap -A 192.168.96.4  //<hanla></hanla>强力扫描，耗时长

15. nmap -6 ipv6<hanla></hanla>地址   //<hanla></hanla>对<hanla></hanla>ipv6<hanla></hanla>地址的主机进行扫描

16. nmap -f 192.168.96.4  //<hanla></hanla>使用小数据包发送，避免被识别出

17. nmap –mtu <size> 192.168.96.4 //<hanla></hanla>发送的包大小,<hanla></hanla>最大传输单元必须是<hanla></hanla>8<hanla></hanla>的整数

18. nmap -D &lt;假<hanla></hanla>ip&gt; 192.168.96.4 //<hanla></hanla>发送参杂着假<hanla></hanla>ip<hanla></hanla>的数据包检测

19. nmap --source-port <portnumber> //<hanla></hanla>针对防火墙只允许的源端口

20. nmap –data-length: <length> 192.168.96.4 //<hanla></hanla>改变发生数据包的默认的长度，避免被识别出来是<hanla></hanla>nmap<hanla></hanla>发送的。

21. nmap -v 192.168.96.4  //<hanla></hanla>显示冗余信息<hanla></hanla>(扫描细节)

22. nmap -sn 192.168.96.4  //<hanla></hanla>对目标进行<hanla></hanla>ping<hanla></hanla>检测，不进行端口扫描（会发送四种报文确定目标是否存活,）

23. nmap -sP 192.168.96.4  //<hanla></hanla>仅仅对目标进行<hanla></hanla>ping<hanla></hanla>检测。

24. nmap -n/-p 192.168.96.4  //-n<hanla></hanla>表示不进行<hanla></hanla>dns<hanla></hanla>解析，-p<hanla></hanla>表示要

25. nmap --system-dns 192.168.96.4  //<hanla></hanla>扫描指定系统的<hanla></hanla>dns<hanla></hanla>服务器

26. nmap –traceroute 192.168.96.4  //<hanla></hanla>追踪每个路由节点。

27. nmap -PE/PP/PM: 使用<hanla></hanla>ICMP echo, timestamp, and netmask 请求包发现主机。

28. nmap -sP 192.168.96.4       //<hanla></hanla>主机存活性扫描，arp<hanla></hanla>直连方式。

29. nmap -iR [number]       //<hanla></hanla>对随机生成<hanla></hanla>number<hanla></hanla>个地址进行扫描

30.namp -F   //<hanla></hanla>扫描<hanla></hanla>100<hanla></hanla>个最有可能开放的端口
</length></portnumber></size></scirptfile></portnumber></code></pre>
<h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><pre><code><hanla></hanla>1.<hanla></hanla>指定<hanla></hanla>ip<hanla></hanla>地址扫描（ping<hanla></hanla>扫描）
nmap -sn 192.168.3.74

2.<hanla></hanla>提取文件中的<hanla></hanla>ip<hanla></hanla>地址
namp -iL target.txt

3.<hanla></hanla>扫描整个网段：
namp 192.168.3.1/24

4.<hanla></hanla>扫描主机指定的端口 
nmap 192.168.3.74 -p80

5.<hanla></hanla>使用<hanla></hanla>tcp<hanla></hanla>的<hanla></hanla>syn<hanla></hanla>进行扫描，半开放扫描只发送<hanla></hanla>syn
nmap -sS 192.168.3.74

6.<hanla></hanla>使用<hanla></hanla>TCP<hanla></hanla>进行扫描，默认扫描
namp -sT 192.168.3.74

7.<hanla></hanla>使用<hanla></hanla>udp<hanla></hanla>扫描
nmap -sU 192.168.3.74

8.<hanla></hanla>使用<hanla></hanla>FIN<hanla></hanla>扫描
nmap -sF 192.1683.74

6.idle<hanla></hanla>扫描（需要指定另外一台主机<hanla></hanla>IP<hanla></hanla>地址，并且目标主机的<hanla></hanla>IPID<hanla></hanla>是递增的）
idlescan<hanla></hanla>是一种理想的扫描方式，它使用另一台网络上的主机替你发送数据包，从而隐藏自己。
nmap -sI&nbsp; 192.168.3.227 192.168.3.74

7.nmap -iLtarget.txt -excludefile exc.txt  扫描<hanla></hanla>target.txt<hanla></hanla>内容排除 exc.txt<hanla></hanla>里面的内容

8.<hanla></hanla>使用<hanla></hanla>UDP ping<hanla></hanla>主机探测：
nmap -PU 192.168.1.1/24
</code></pre>
<h2 id="nmap脚本"><a href="#nmap脚本" class="headerlink" title="nmap脚本"></a><hanla></hanla>nmap<hanla></hanla>脚本</h2><pre><code><hanla></hanla>1.<hanla></hanla>脚本分类
nmap<hanla></hanla>脚本主要分为以下几类，在扫描时可根据需要设置--script=<hanla></hanla>类别这种方式进行比较笼统的扫描：
auth: 负责处理鉴权证书（绕开鉴权）的脚本  
broadcast: 在局域网内探查更多服务开启状况，如<hanla></hanla>dhcp/dns/sqlserver<hanla></hanla>等服务  
brute: 提供暴力破解方式，针对常见的应用如<hanla></hanla>http/snmp<hanla></hanla>等  
default: 使用-sC<hanla></hanla>或-A<hanla></hanla>选项扫描时候默认的脚本，提供基本脚本扫描能力  
discovery: 对网络进行更多的信息，如<hanla></hanla>SMB<hanla></hanla>枚举、SNMP<hanla></hanla>查询等  
dos: 用于进行拒绝服务攻击  
exploit: 利用已知的漏洞入侵系统  
external: 利用第三方的数据库或资源，例如进行<hanla></hanla>whois<hanla></hanla>解析  
fuzzer: 模糊测试的脚本，发送异常的包到目标机，探测出潜在漏洞 intrusive: 入侵性的脚本，此类脚本可能引发对方的<hanla></hanla>IDS/IPS<hanla></hanla>的记录或屏蔽  
malware: 探测目标机是否感染了病毒、开启了后门等信息  
safe: 此类与<hanla></hanla>intrusive<hanla></hanla>相反，属于安全性脚本  
version: 负责增强服务与版本扫描（Version Detection）功能的脚本  
vuln: 负责检查目标机是否有常见的漏洞（Vulnerability），如是否有<hanla></hanla>MS08_067

（1）&nbsp;nmap --script=auth 192.168.137.*
负责处理鉴权证书（绕开鉴权）的脚本,<hanla></hanla>也可以作为检测部分应用弱口令

（2）nmap --script=brute 192.168.137.*
提供暴力破解的方式 &nbsp;可对数据库，smb，snmp<hanla></hanla>等进行简单密码的暴力猜解

（3）nmap --script=default 192.168.137.*&nbsp;或者&nbsp;nmap -sC 192.168.137.*
默认的脚本扫描，主要是搜集各种应用服务的信息，收集到后，可再针对具体服务进行攻击

（4）nmap --script=vuln 192.168.137.*&nbsp;&nbsp;&nbsp;
检查是否存在常见漏洞

（5）nmap -n -p445 --script=broadcast 192.168.137.4
在局域网内探查更多服务开启状况

（6）nmap --script external 202.103.243.110&nbsp;

利用第三方的数据库或资源，例如进行<hanla></hanla>whois<hanla></hanla>解析

（1）vnc<hanla></hanla>扫描：
检查<hanla></hanla>vnc bypass
nmap &nbsp;--script=realvnc-auth-bypass 192.168.137.4
检查<hanla></hanla>vnc<hanla></hanla>认证方式
nmap &nbsp;--script=vnc-auth &nbsp;192.168.137.4&nbsp;
获取<hanla></hanla>vnc<hanla></hanla>信息
nmap &nbsp;--script=vnc-info &nbsp;192.168.137.4

（2）smb<hanla></hanla>扫描：
smb<hanla></hanla>破解
nmap&nbsp; --script=smb-brute.nse 192.168.137.4
smb<hanla></hanla>字典破解
nmap --script=smb-brute.nse --script-args=userdb=/var/passwd
,passdb=/var/passwd 192.168.137.4
smb<hanla></hanla>已知几个严重漏
nmap &nbsp;--script=smb-check-vulns.nse --script-args=unsafe=1 192.168.137.4
查看共享目录 
nmap -p 445 &nbsp;--script smb-ls --script-args ‘share=e$,path=\,smbuser=test,smbpass=
test’ 192.168.137.4

（3）Mssql<hanla></hanla>扫描：
猜解<hanla></hanla>mssql<hanla></hanla>用户名和密码
nmap -p1433 --script=ms-sql-brute --script-args=userdb=/var/passwd,passdb=/var/passwd 192.168.137.4&nbsp;


nmap --script=broadcast-netbios-master-browser 192.168.137.4 &nbsp; 发现网关&nbsp;&nbsp;

nmap -p 873 --script rsync-brute --script-args 'rsync-brute.module=www' 192.168.137.4 &nbsp;破解<hanla></hanla>rsync&nbsp;&nbsp;

nmap --script informix-brute -p 9088 192.168.137.4 &nbsp; &nbsp;informix<hanla></hanla>数据库破解&nbsp;&nbsp;

nmap -p 5432 --script pgsql-brute 192.168.137.4 &nbsp; &nbsp; &nbsp; pgsql<hanla></hanla>破解&nbsp;&nbsp;

nmap -sU --script snmp-brute 192.168.137.4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;snmp<hanla></hanla>破解&nbsp;&nbsp;

nmap -sV --script=telnet-brute 192.168.137.4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;telnet<hanla></hanla>破解&nbsp;&nbsp;

nmap --script=http-vuln-cve2010-0738 --script-args 'http-vuln-cve2010-0738.paths={/path1/,/path2/}' <target> &nbsp;jboss autopwn&nbsp;&nbsp;

nmap --script=http-methods.nse 192.168.137.4 检查<hanla></hanla>http<hanla></hanla>方法&nbsp;&nbsp;

nmap --script http-slowloris --max-parallelism 400 192.168.137.4 &nbsp;dos<hanla></hanla>攻击，对于处理能力较小的站点还挺好用的 'half-HTTP' connections&nbsp;&nbsp;&nbsp;

nmap --script=samba-vuln-cve-2012-1182 &nbsp;-p 139 192.168.137.4
</target></code></pre>
<p>这里有个链接可以没事看看<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/whatday/article/details/73823959?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522162997555716780274133724%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=162997555716780274133724&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v29_ecpm-7-73823959.first_rank_v2_pc_rank_v29&amp;utm_term=nmap+nse+%E5%8A%9F%E8%83%BD%E6%80%BB%E7%BB%93&amp;spm=1018.2226.3001.4187"><hanla></hanla>https://blog.csdn.net/whatday/article/details/73823959?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522162997555716780274133724%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=162997555716780274133724&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v29_ecpm-7-73823959.first_rank_v2_pc_rank_v29&amp;utm_term=nmap+nse+%E5%8A%9F%E8%83%BD%E6%80%BB%E7%BB%93&amp;spm=1018.2226.3001.4187</a></p>
<p><a target="_blank" rel="noopener" href="https://imagelol.com/image/Im00gL"><img src="https://s3.jpg.cm/2021/09/30/Im00gL.png" alt="Im00gL.png"></a></p>
<h2 id="实例演示-获得服务版本详细信息"><a href="#实例演示-获得服务版本详细信息" class="headerlink" title="实例演示-获得服务版本详细信息"></a>实例演示-获得服务版本详细信息</h2><p><hanla></hanla>使用<hanla></hanla>UDP ping<hanla></hanla>探测主机<br><hanla></hanla>nmap -PU 192.168.1.0/24</p>
<p>服务版本探测<br><hanla></hanla>nmap -sV 192.168.3.74</p>
<p>精确的确认端口上运行的服务<br><hanla></hanla>nmap -sV –script unusual-port 192.168.1.1</p>
<p><a target="_blank" rel="noopener" href="https://imagelol.com/image/Im0zHH"><img src="https://s3.jpg.cm/2021/09/30/Im0zHH.png" alt="Im0zHH.png"></a></p>
<p>-oN  导出扫描结果<br><hanla></hanla>-oX 导出扫描结果为<hanla></hanla>xml<hanla></hanla>格式</p>
<p><a target="_blank" rel="noopener" href="https://imagelol.com/image/Im0gq2"><img src="https://s3.jpg.cm/2021/09/30/Im0gq2.png" alt="Im0gq2.png"></a></p>
<p><a target="_blank" rel="noopener" href="https://imagelol.com/image/Im0BKW"><img src="https://s3.jpg.cm/2021/09/30/Im0BKW.png" alt="Im0BKW.png"></a></p>
<pre><code><hanla></hanla>对目标进行<hanla></hanla>IP<hanla></hanla>反查
nmap -sn --script hostmap-ip2hosts www.hao123.com

对目标<hanla></hanla>DNS<hanla></hanla>信息的收集
nmap --script dns-brute www.test.com
nmap --script dns-brute dns-brute.threads=10 www.test.com

了解目标系统的详细信息
nmap -p 445 192.168.23.1 --script membase-http-info

检查打印服务漏洞
nmap --script smb-security-mode.nse -p 445 192.168.21.3

扫描目标的<hanla></hanla>xss<hanla></hanla>漏洞
nmap -p80 --script http-stored-xss.nse www.test.com


扫描目标的<hanla></hanla>SQL<hanla></hanla>注入漏洞
nmap -p8001 --script http-sql-injection.nse 192.168.0.200

对目标地址进行<hanla></hanla>HTTP<hanla></hanla>头信息探测
nmap -p 80 --script=http-headers test.com

爬行<hanla></hanla>web<hanla></hanla>目录结构

nmap -p 80 --script=http-sitemap-generator www.test.com
Snmp

服务获取目标正在运行着的服务，通过<hanla></hanla>Snmp<hanla></hanla>服务对目标系统的服务或账户进行列举
nmap -sU -p 161 --script=snmp-win32-services 192.168.87.129

暴力破解
VNC
nmap --script vnc-brute --script-args brute.guesses=6,brute.emptypass=true,userdb=/root/dictionary/user.txt,brute.useraspass=true,passdb=/root/dictionary/pass.txt,brute.retries=3,brute.threads=2,brute.delay=3 42.96.170.128


破解<hanla></hanla>telnet
nmap -p 23 --script telnet-brute --script-args userdb=myusers.lst,passdb=mypwds.lst --script-args telnet-brute.timeout=8s 192.168.1.1
ftp

弱口令暴力破解
nmap --script ftp-brute --script-args brute.emptypass=true,ftp-brute.timeout=30,userdb=/root/dirtionary/usernames.txt,brute.useraspass=true,passdb=/root/dirtionary/passwords.txt,brute.threads=3,brute.delay=6 192.168.1.1

扫描系统漏洞
nmap --script vuln 192.168.1.1
IIS 

短文件泄露
nmap -p 8080 --script http-iis-short-name-brute 192.168.1.1

拒绝服务
nmap --max-parallelism 800--script http-slowloris www.cracer.com


验证<hanla></hanla>http 中开启了<hanla></hanla>put 方法
nmap --script http-put --script-args http-put.url=/uploads/testput.txt,http-put.file=/root/put.txt 218.19.141.16

验证<hanla></hanla>MySQL 匿名访问
nmap --script mysql-empty-password 203.195.139.153

-f 分片绕过
-D<hanla></hanla>使用诱饵隐蔽扫描
NMAP -D 1.1.1.1,222.222.222.222 www.cracer.com
--source-port  源端口欺骗
</code></pre>

    </div>

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    <div id="comment">
        <div id="gitalk-container">
        </div>
    </div>
    
</div>
                     
<footer id="footer">
    <div class="footer-wrap">
        <div>
            © 2018 - 2021 Hongxiaodou
            <span class="footer-icon">
                <a-icon type="flag" theme="filled"></a-icon></span>
            @hongxiaodou
        </div>
        <div></div>
        <div>Based on the <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo Engine</a> &amp; <a target="_blank" rel="noopener" href="https://github.com/korilin/hexo-theme-particle">Particle Theme</a></div>
        
    </div>

</footer>

<script src="/js/highlight.min.js"></script>
<script src="/js/particle.js"></script>
                </div>
            </div>
        </transition>
    </div>

    <script>
    new Vue({
        el: "#layout",
        data: {
            show_page: false,
            onload_menu: false,
            menu_show: false,
            card_top: 100
        },
        created: function () {
            var that = this
            window.onload = function () {
                that.show_page = true
                document.getElementById("loadcontent").style.opacity = 0
                setTimeout(function () {
                    document.getElementById("loadleft").style.width = 0
                    document.getElementById("loadright").style.width = 0
                }, 300)
                setTimeout(function () {
                    document.getElementById("loading").style = "display:none"
                }, 600)
            }
        },
        mounted: function () {
            var that = this
            window.addEventListener('scroll', function (e) {
                that.menu_show = false
            })
        },
        methods: {
            home_click: function () {
                window.scrollTo({
                    top: window.innerHeight - 80,
                    behavior: "smooth",
                });
            }
        }
    })
</script>

<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script>
    const gitalk = new Gitalk({
        clientID: '',
        clientSecret: '',
        repo: 'hexo-theme-particle',      // The repository of store comments,
        owner: 'korilin',
        admin: ['korilin'],
        language: 'zh-CN',
        id: location.pathname,      // Ensure uniqueness and length less than 50
        distractionFreeMode: true  // Facebook-like distraction free mode
    })
    gitalk.render('gitalk-container')
</script>



</body></html>